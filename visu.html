<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>프로젝트 정보 파이프라인 (상세)</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f9f9f9;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            color: #333;
        }
        .container {
            width: 100%;
            max-width: 1400px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 20px;
            box-sizing: border-box;
        }
        h1 {
            text-align: center;
            color: #1a73e8;
            margin-bottom: 20px;
        }
        svg {
            width: 100%;
            height: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>프로젝트 정보 파이프라인 시각화 (상세 버전)</h1>
        <svg viewBox="0 0 1400 900" xmlns="http://www.w3.org/2000/svg">
            <!-- SVG Definitions for markers (arrowheads) -->
            <defs>
                <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5"
                    markerWidth="6" markerHeight="6"
                    orient="auto-start-reverse">
                    <path d="M 0 0 L 10 5 L 0 10 z" fill="#5f6368" />
                </marker>
            </defs>

            <!-- Background Sections (品 layout) -->
            <rect x="10" y="10" width="1380" height="400" rx="15" fill="#e3f2fd" stroke="#bbdefb" stroke-width="2"/>
            <text x="30" y="45" font-size="24" font-weight="bold" fill="#1967d2">Google Cloud & External</text>

            <rect x="10" y="420" width="685" height="470" rx="15" fill="#e8f5e9" stroke="#c8e6c9" stroke-width="2"/>
            <text x="30" y="455" font-size="24" font-weight="bold" fill="#2e7d32">Localhost / Developer & User</text>

            <rect x="705" y="420" width="685" height="470" rx="15" fill="#fff3e0" stroke="#ffe0b2" stroke-width="2"/>
            <text x="725" y="455" font-size="24" font-weight="bold" fill="#e65100">Firebase</text>

            <!-- Nodes -->
            <!-- Google Cloud Nodes -->
            <g id="node-scheduler">
                <rect x="50" y="150" width="220" height="100" rx="10" fill="#ffffff" stroke="#1967d2" stroke-width="2"/>
                <text x="160" y="190" text-anchor="middle" font-size="18">Cloud Scheduler</text>
                <text x="160" y="215" text-anchor="middle" font-size="14" fill="#5f6368">gcloud-config.json</text>
                 <text x="160" y="235" text-anchor="middle" font-size="14" fill="#5f6368">"*/2 * * * *"</text>
            </g>
            <g id="node-cloudrun-container">
                 <rect x="350" y="80" width="400" height="280" rx="10" fill="#d0e7fb" stroke="#1967d2" stroke-width="1" stroke-dasharray="5,5"/>
                 <text x="550" y="110" text-anchor="middle" font-size="18" font-weight="bold" fill="#1967d2">Cloud Run Container</text>
            </g>
            <g id="node-express-server">
                <rect x="380" y="130" width="340" height="200" rx="10" fill="#ffffff" stroke="#1967d2" stroke-width="2"/>
                <text x="550" y="160" text-anchor="middle" font-size="18">Express Server</text>
                <text x="550" y="180" text-anchor="middle" font-size="14" fill="#5f6368">(index.ts)</text>
                <line x1="400" y1="190" x2="700" y2="190" stroke="#bbdefb" stroke-width="1"/>
                <rect x="400" y="200" width="140" height="50" rx="5" fill="#e3f2fd"/>
                <text x="470" y="230" text-anchor="middle" font-size="14">GET /crawl</text>
                <rect x="560" y="200" width="140" height="50" rx="5" fill="#e3f2fd"/>
                <text x="630" y="230" text-anchor="middle" font-size="14">GET /logs</text>
                <text x="550" y="280" text-anchor="middle" font-size="16" fill="#1967d2">Crawler Module</text>
                <text x="550" y="300" text-anchor="middle" font-size="14" fill="#5f6368">(crawler.ts)</text>
            </g>
            <g id="node-everytime">
                <rect x="850" y="150" width="220" height="100" rx="10" fill="#ffebee" stroke="#d32f2f" stroke-width="2"/>
                <text x="960" y="200" text-anchor="middle" font-size="18">Everytime API</text>
                <text x="960" y="225" text-anchor="middle" font-size="14" fill="#5f6368">(External Service)</text>
            </g>

            <!-- Localhost / User Nodes -->
            <g id="node-developer">
                <rect x="50" y="500" width="280" height="150" rx="10" fill="#ffffff" stroke="#2e7d32" stroke-width="2"/>
                <text x="190" y="530" text-anchor="middle" font-size="18">Developer</text>
                <text x="190" y="550" text-anchor="middle" font-size="14" fill="#5f6368">(Localhost)</text>
                <line x1="70" y1="565" x2="310" y2="565" stroke="#c8e6c9" stroke-width="1"/>
                <text x="190" y="590" text-anchor="middle" font-size="14">`npm run dev`</text>
                <text x="190" y="610" text-anchor="middle" font-size="14">`docker build` / `push`</text>
                <text x="190" y="630" text-anchor="middle" font-size="14">`deploy-and-schedule.sh`</text>
            </g>
             <g id="node-end-user">
                <rect x="380" y="680" width="280" height="150" rx="10" fill="#ffffff" stroke="#2e7d32" stroke-width="2"/>
                <text x="520" y="710" text-anchor="middle" font-size="18">End User</text>
                <text x="520" y="730" text-anchor="middle" font-size="14" fill="#5f6368">(Browser)</text>
                <line x1="400" y1="745" x2="640" y2="745" stroke="#c8e6c9" stroke-width="1"/>
                <text x="520" y="770" text-anchor="middle" font-size="14">View `logs.html`</text>
                <text x="520" y="790" text-anchor="middle" font-size="14">JS `fetch('/logs')`</text>
                <text x="520" y="810" text-anchor="middle" font-size="14">Display logs in table</text>
            </g>

            <!-- Firebase Nodes -->
            <g id="node-firebase-sdk">
                <rect x="920" y="500" width="260" height="80" rx="10" fill="#ffffff" stroke="#e65100" stroke-width="2"/>
                <text x="1050" y="535" text-anchor="middle" font-size="18">Firebase Admin SDK</text>
                <text x="1050" y="555" text-anchor="middle" font-size="14" fill="#5f6368">(firebase.ts, logger.ts)</text>
            </g>
            <g id="node-firestore-articles">
                <rect x="780" y="680" width="280" height="150" rx="10" fill="#ffffff" stroke="#e65100" stroke-width="2"/>
                <text x="920" y="710" text-anchor="middle" font-size="18">Firestore: 'articles'</text>
                <text x="920" y="730" text-anchor="middle" font-size="14" fill="#5f6368">(게시글 원본 저장)</text>
                <line x1="800" y1="745" x2="1040" y2="745" stroke="#ffe0b2" stroke-width="1"/>
                <text x="920" y="770" text-anchor="middle" font-size="14">id, title, text</text>
                <text x="920" y="790" text-anchor="middle" font-size="14">posvote, comment</text>
                <text x="920" y="810" text-anchor="middle" font-size="14">created_at, updated_at</text>
            </g>
            <g id="node-firestore-logs">
                <rect x="1080" y="680" width="280" height="150" rx="10" fill="#ffffff" stroke="#e65100" stroke-width="2"/>
                <text x="1220" y="710" text-anchor="middle" font-size="18">Firestore: 'logs'</text>
                <text x="1220" y="730" text-anchor="middle" font-size="14" fill="#5f6368">(변경 내역 기록)</text>
                 <line x1="1100" y1="745" x2="1340" y2="745" stroke="#ffe0b2" stroke-width="1"/>
                <text x="1220" y="770" text-anchor="middle" font-size="14">timestamp, type</text>
                <text x="1220" y="790" text-anchor="middle" font-size="14">details, article_id</text>
                <text x="1220" y="810" text-anchor="middle" font-size="14">before, after</text>
            </g>

            <!-- Links (Data Flow) -->
            <!-- Deploy Flow -->
            <path d="M 190 650 C 190 400, 350 400, 450 360" stroke="#2e7d32" stroke-width="2" fill="none" marker-end="url(#arrow)" stroke-dasharray="8,4"/>
            <text x="250" y="450" font-size="14" fill="#2e7d32" transform="rotate(-30, 250, 450)">Deploy</text>

            <!-- Crawl Flow -->
            <line x1="270" y1="200" x2="380" y2="220" stroke="#5f6368" stroke-width="2" marker-end="url(#arrow)" />
            <text x="320" y="200" font-size="14" fill="#333">1. Trigger</text>

            <path d="M 720 225 C 800 225, 800 200, 850 200" stroke="#5f6368" stroke-width="2" fill="none" marker-end="url(#arrow)" />
            <text x="780" y="210" font-size="14" fill="#333">2. API Request</text>
            <path d="M 850 210 C 800 210, 800 235, 720 235" stroke="#5f6368" stroke-width="2" fill="none" marker-end="url(#arrow)" />
            <text x="780" y="250" font-size="14" fill="#333">3. XML Response</text>

            <path d="M 550 330 C 550 450, 850 450, 920 520" stroke="#5f6368" stroke-width="2" fill="none" marker-end="url(#arrow)" />
            <text x="750" y="440" font-size="14" fill="#333">4. Use SDK</text>

            <path d="M 980 580 C 950 620, 920 650, 920 680" stroke="#5f6368" stroke-width="2" fill="none" marker-end="url(#arrow)" />
            <text x="900" y="630" font-size="14" fill="#333">5. R/W Articles</text>
            <path d="M 1120 580 C 1150 620, 1180 650, 1220 680" stroke="#5f6368" stroke-width="2" fill="none" marker-end="url(#arrow)" />
            <text x="1170" y="630" font-size="14" fill="#333">6. Write Logs</text>

            <!-- Log Viewer Flow -->
            <path d="M 520 680 C 420 600, 420 330, 560 250" stroke="#0288d1" stroke-width="2" fill="none" marker-end="url(#arrow)" />
            <text x="380" y="480" font-size="14" fill="#0288d1">A. GET /logs</text>

            <path d="M 630 250 C 800 350, 900 450, 980 500" stroke="#0288d1" stroke-width="2" fill="none" marker-end="url(#arrow)" />
            <text x="850" y="420" font-size="14" fill="#0288d1">B. Use SDK</text>

            <path d="M 1150 680 C 1150 620, 1120 580, 1120 570" stroke="#0288d1" stroke-width="2" fill="none" marker-end="url(#arrow)" />
            <text x="1160" y="610" font-size="14" fill="#0288d1">C. Read Logs</text>

            <path d="M 1050 500 C 800 400, 600 500, 520 680" stroke="#0288d1" stroke-width="2" fill="none" marker-end="url(#arrow)" />
            <text x="750" y="580" font-size="14" fill="#0288d1">D. JSON Response</text>

        </svg>
    </div>
</body>
</html>
